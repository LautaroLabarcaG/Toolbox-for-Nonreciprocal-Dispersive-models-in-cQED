(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49118,       1209]
NotebookOptionsPosition[     44927,       1128]
NotebookOutlinePosition[     45368,       1145]
CellTagsIndexPosition[     45325,       1142]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Junctions coupled through 3 mode circulator", "Title",
 CellChangeTimes->{{3.925382608823904*^9, 
  3.925382621968903*^9}},ExpressionUUID->"f7d9a2fc-2c7f-4264-8593-\
373c5e8eead6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Assume", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"theta", " ", "\[Element]", " ", "PositiveReals"}], ",", " ", 
     RowBox[{"varphi", " ", "\[Element]", " ", "PositiveReals"}], ",", " ", 
     RowBox[{"Cj", " ", "\[Element]", " ", "PositiveReals"}], ",", 
     RowBox[{"Cjr", "\[Element]", " ", "PositiveReals"}], ",", " ", 
     RowBox[{"Cr", " ", "\[Element]", " ", "PositiveReals"}], ",", " ", 
     RowBox[{"Lr", " ", "\[Element]", " ", "PositiveReals"}], ",", " ", 
     RowBox[{"Crs", " ", "\[Element]", " ", "PositiveReals"}], ",", " ", 
     RowBox[{"Cg", " ", "\[Element]", " ", "PositiveReals"}]}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"assum", " ", "=", " ", "Assume"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$Assumptions", " ", "=", " ", "Assume"}]}], "Input",
 CellChangeTimes->{{3.925387348794827*^9, 3.9253873522527742`*^9}, {
  3.925387488294426*^9, 3.925387599006811*^9}, {3.925387922467937*^9, 
  3.9253879292653713`*^9}},
 CellLabel->
  "In[3306]:=",ExpressionUUID->"50cc4282-9269-4ec5-9bbf-c6fd43178e26"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"theta", "\[Element]", 
     TemplateBox[{},
      "Reals"]}], "&&", 
    RowBox[{"theta", ">", "0"}]}], ",", 
   RowBox[{
    RowBox[{"varphi", "\[Element]", 
     TemplateBox[{},
      "Reals"]}], "&&", 
    RowBox[{"varphi", ">", "0"}]}], ",", 
   RowBox[{
    RowBox[{"Cj", "\[Element]", 
     TemplateBox[{},
      "Reals"]}], "&&", 
    RowBox[{"Cj", ">", "0"}]}], ",", 
   RowBox[{
    RowBox[{"Cjr", "\[Element]", 
     TemplateBox[{},
      "Reals"]}], "&&", 
    RowBox[{"Cjr", ">", "0"}]}], ",", 
   RowBox[{
    RowBox[{"Cr", "\[Element]", 
     TemplateBox[{},
      "Reals"]}], "&&", 
    RowBox[{"Cr", ">", "0"}]}], ",", 
   RowBox[{
    RowBox[{"Lr", "\[Element]", 
     TemplateBox[{},
      "Reals"]}], "&&", 
    RowBox[{"Lr", ">", "0"}]}], ",", 
   RowBox[{
    RowBox[{"Crs", "\[Element]", 
     TemplateBox[{},
      "Reals"]}], "&&", 
    RowBox[{"Crs", ">", "0"}]}], ",", 
   RowBox[{
    RowBox[{"Cg", "\[Element]", 
     TemplateBox[{},
      "Reals"]}], "&&", 
    RowBox[{"Cg", ">", "0"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.925387599246458*^9, {3.9253876391293*^9, 3.925387640887236*^9}, {
   3.9253879260210743`*^9, 3.925387929492682*^9}, 3.925394680039338*^9, 
   3.925402340308331*^9, 3.925406140570025*^9, 3.9254062200237722`*^9, 
   3.925407323929001*^9, {3.925462225171339*^9, 3.925462239293396*^9}, 
   3.9254627014193287`*^9, 3.925462864729127*^9, 3.925464093233664*^9, 
   3.9254644462406178`*^9, 3.925464833109603*^9, {3.9254649790960903`*^9, 
   3.9254650069502783`*^9}, 3.92546581874844*^9, 3.925466740841062*^9, {
   3.9254677353827143`*^9, 3.925467777701226*^9}, 3.9254688471514683`*^9, 
   3.925489103456869*^9, 3.925489312015679*^9, 3.925491485877583*^9, 
   3.925491615361175*^9, 3.925491711959938*^9, 3.925491985282255*^9, 
   3.925492300660034*^9, 3.92549259002089*^9, 3.925492879715308*^9, {
   3.925543752651924*^9, 3.925543765626123*^9}, 3.925544585397131*^9, {
   3.925544864415392*^9, 3.9255448932984123`*^9}, 3.925544995840392*^9, 
   3.925545151799354*^9, 3.92554533846341*^9, 3.925546897918099*^9, 
   3.925552789224909*^9, 3.9255531322061863`*^9, 3.9255543838345737`*^9, 
   3.925554923361244*^9, 3.925555030604704*^9, 3.925555218071678*^9, 
   3.9255609673576097`*^9, 3.925561212057951*^9, 3.925561370158939*^9, 
   3.92556152383636*^9, {3.925659728455719*^9, 3.925659752538816*^9}, 
   3.9256632696972017`*^9, 3.926698560893906*^9, 3.926701182715267*^9},
 CellLabel->
  "Out[3308]=",ExpressionUUID->"60782d04-5102-4118-a30a-90b1f2bef16b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Getting the Y from S", "Subtitle",
 CellChangeTimes->{{3.92488627781761*^9, 3.924886280941972*^9}, {
  3.9254059713618402`*^9, 
  3.925405972390422*^9}},ExpressionUUID->"b3e78691-0abe-4061-9e34-\
bb48caf0132a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n1", " ", "=", 
   RowBox[{
    RowBox[{"Sin", "[", "theta", "]"}], "*", 
    RowBox[{"Cos", "[", "varphi", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n2", " ", "=", 
   RowBox[{
    RowBox[{"Sin", "[", "theta", "]"}], "*", 
    RowBox[{"Sin", "[", "varphi", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n3", " ", "=", " ", 
   RowBox[{"Cos", "[", "theta", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rnbeta", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "beta", "]"}], "+", 
        RowBox[{
         RowBox[{"n1", "^", "2"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "beta", "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"n1", "*", "n2", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "beta", "]"}]}], ")"}]}], "-", 
        RowBox[{"n3", "*", 
         RowBox[{"Sin", "[", "beta", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"n1", "*", "n3", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "beta", "]"}]}], ")"}]}], "+", 
        RowBox[{"n2", "*", 
         RowBox[{"Sin", "[", "beta", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"n1", "*", "n2", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "beta", "]"}]}], ")"}]}], "+", 
        RowBox[{"n3", "*", 
         RowBox[{"Sin", "[", "beta", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "beta", "]"}], "+", 
        RowBox[{
         RowBox[{"n2", "^", "2"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "beta", "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"n2", "*", "n3", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "beta", "]"}]}], ")"}]}], "-", 
        RowBox[{"n1", "*", 
         RowBox[{"Sin", "[", "beta", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"n1", "*", "n3", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "beta", "]"}]}], ")"}]}], "-", 
        RowBox[{"n2", "*", 
         RowBox[{"Sin", "[", "beta", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"n2", "*", "n3", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "beta", "]"}]}], ")"}]}], "+", 
        RowBox[{"n1", "*", 
         RowBox[{"Sin", "[", "beta", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "beta", "]"}], "+", 
        RowBox[{
         RowBox[{"n3", "^", "2"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", "beta", "]"}]}], ")"}]}]}]}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rx", " ", "=", " ", 
   RowBox[{"Rnbeta", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"theta", "->", 
       RowBox[{"Pi", "/", "2"}]}], ",", 
      RowBox[{"varphi", "->", "0"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ry", " ", "=", " ", 
   RowBox[{"Rnbeta", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"theta", "->", 
       RowBox[{"Pi", "/", "2"}]}], ",", 
      RowBox[{"varphi", "->", 
       RowBox[{"Pi", "/", "2"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rz", " ", "=", " ", 
   RowBox[{"Rnbeta", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"theta", "->", "0"}], ",", 
      RowBox[{"varphi", "->", "0"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", " ", "=", " ", 
   RowBox[{"Rz", "/.", 
    RowBox[{"{", 
     RowBox[{"beta", "->", 
      RowBox[{
       RowBox[{"-", "Pi"}], "/", "4"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2", "=", " ", 
   RowBox[{"Ry", "/.", 
    RowBox[{"{", 
     RowBox[{"beta", "->", 
      RowBox[{"Arg", "[", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", "/", "3"}], "]"}], "+", 
        RowBox[{"I", "/", 
         RowBox[{"Sqrt", "[", "3", "]"}]}]}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Rnbeta", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"varphi", "->", "0"}], ",", 
       RowBox[{"theta", "->", "0"}], ",", 
       RowBox[{"beta", "->", "0"}]}], "}"}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rr", " ", "=", " ", 
   RowBox[{"R2", ".", "R1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I3", "=", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "Rr", "]"}], ".", "Rx", ".", "Rr"}], "/.", 
     RowBox[{"{", 
      RowBox[{"beta", "->", "phi"}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"S", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Rnbeta", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"theta", "->", 
        RowBox[{"Arg", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "/", "3"}], "]"}], "+", 
          RowBox[{"I", "*", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"2", "/", "3"}], "]"}]}]}], "]"}]}], ",", 
       RowBox[{"varphi", "->", 
        RowBox[{"Pi", "/", "4"}]}], ",", 
       RowBox[{"beta", "->", 
        RowBox[{"2", 
         RowBox[{"Pi", "/", "3"}]}]}]}], "}"}]}], "//", "FullSimplify"}], "//",
    "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "/.", 
   RowBox[{"{", 
    RowBox[{"phi", "->", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "3"}]}]}], "}"}]}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.924805766789707*^9, 3.92480584022509*^9}, 
   3.92480596147474*^9, {3.9254671227930813`*^9, 3.925467131338183*^9}},
 CellLabel->
  "In[3309]:=",ExpressionUUID->"eb613276-7ebe-46ef-9df0-035a067b1ca8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", "phi", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "phi", "]"}], "-", 
         RowBox[{
          SqrtBox["3"], " ", 
          RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "phi", "]"}], "+", 
         RowBox[{
          SqrtBox["3"], " ", 
          RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "phi", "]"}], "+", 
         RowBox[{
          SqrtBox["3"], " ", 
          RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", "phi", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "phi", "]"}], "-", 
         RowBox[{
          SqrtBox["3"], " ", 
          RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "phi", "]"}], "-", 
         RowBox[{
          SqrtBox["3"], " ", 
          RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "phi", "]"}], "+", 
         RowBox[{
          SqrtBox["3"], " ", 
          RowBox[{"Sin", "[", "phi", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", "phi", "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9248057464694366`*^9, 3.9248057709519873`*^9}, {
   3.924805834039143*^9, 3.9248058405932417`*^9}, 3.924805961973928*^9, 
   3.92486929352563*^9, {3.925132147365746*^9, 3.925132169352577*^9}, 
   3.925282877545104*^9, {3.925317418355135*^9, 3.925317418567712*^9}, 
   3.925382641719591*^9, 3.9253876447429*^9, {3.925394638097954*^9, 
   3.925394638360341*^9}, 3.9254023405014267`*^9, 3.925405984513085*^9, 
   3.925406140649641*^9, 3.925406220104734*^9, 3.925407324023705*^9, 
   3.925462239549261*^9, {3.92546270615825*^9, 3.925462749596583*^9}, {
   3.925462858597624*^9, 3.925462883575203*^9}, 3.925463028667701*^9, 
   3.925463076353354*^9, 3.9254631877359858`*^9, 3.925463565794285*^9, 
   3.925464105017428*^9, 3.925464833202896*^9, 3.925464931939918*^9, {
   3.9254649791989737`*^9, 3.925465007197289*^9}, 3.9254658188419027`*^9, {
   3.925467125595015*^9, 3.925467132038477*^9}, {3.925467735479562*^9, 
   3.925467777806682*^9}, 3.9254688472470427`*^9, 3.925489103560432*^9, 
   3.925489312423349*^9, 3.9254914859825163`*^9, 3.925491615489093*^9, 
   3.925491712079803*^9, 3.9254919854101267`*^9, 3.925492300773424*^9, 
   3.925492590156521*^9, 3.9254928798264627`*^9, 3.925543768787423*^9, 
   3.925544585565262*^9, {3.925544864540531*^9, 3.925544893429533*^9}, 
   3.925544995972762*^9, 3.925545151927773*^9, 3.925545338590384*^9, 
   3.9255468981684628`*^9, 3.925552789386758*^9, 3.925553132314547*^9, 
   3.925554383944406*^9, 3.925554923483222*^9, 3.9255550308432302`*^9, 
   3.925555218193727*^9, 3.925560967638186*^9, 3.9255612121822977`*^9, 
   3.9255613702732887`*^9, 3.9255615239639053`*^9, {3.925659728772053*^9, 
   3.925659752633778*^9}, 3.925663270208002*^9, 3.9266985609637613`*^9, 
   3.9267011827698*^9},
 CellLabel->
  "Out[3322]//MatrixForm=",ExpressionUUID->"9e24bbc8-2b86-4d7b-874d-\
66e2fe0edf61"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1"},
     {"1", "0", "0"},
     {"0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9248057464694366`*^9, 3.9248057709519873`*^9}, {
   3.924805834039143*^9, 3.9248058405932417`*^9}, 3.924805961973928*^9, 
   3.92486929352563*^9, {3.925132147365746*^9, 3.925132169352577*^9}, 
   3.925282877545104*^9, {3.925317418355135*^9, 3.925317418567712*^9}, 
   3.925382641719591*^9, 3.9253876447429*^9, {3.925394638097954*^9, 
   3.925394638360341*^9}, 3.9254023405014267`*^9, 3.925405984513085*^9, 
   3.925406140649641*^9, 3.925406220104734*^9, 3.925407324023705*^9, 
   3.925462239549261*^9, {3.92546270615825*^9, 3.925462749596583*^9}, {
   3.925462858597624*^9, 3.925462883575203*^9}, 3.925463028667701*^9, 
   3.925463076353354*^9, 3.9254631877359858`*^9, 3.925463565794285*^9, 
   3.925464105017428*^9, 3.925464833202896*^9, 3.925464931939918*^9, {
   3.9254649791989737`*^9, 3.925465007197289*^9}, 3.9254658188419027`*^9, {
   3.925467125595015*^9, 3.925467132038477*^9}, {3.925467735479562*^9, 
   3.925467777806682*^9}, 3.9254688472470427`*^9, 3.925489103560432*^9, 
   3.925489312423349*^9, 3.9254914859825163`*^9, 3.925491615489093*^9, 
   3.925491712079803*^9, 3.9254919854101267`*^9, 3.925492300773424*^9, 
   3.925492590156521*^9, 3.9254928798264627`*^9, 3.925543768787423*^9, 
   3.925544585565262*^9, {3.925544864540531*^9, 3.925544893429533*^9}, 
   3.925544995972762*^9, 3.925545151927773*^9, 3.925545338590384*^9, 
   3.9255468981684628`*^9, 3.925552789386758*^9, 3.925553132314547*^9, 
   3.925554383944406*^9, 3.925554923483222*^9, 3.9255550308432302`*^9, 
   3.925555218193727*^9, 3.925560967638186*^9, 3.9255612121822977`*^9, 
   3.9255613702732887`*^9, 3.9255615239639053`*^9, {3.925659728772053*^9, 
   3.925659752633778*^9}, 3.925663270208002*^9, 3.9266985609637613`*^9, 
   3.926701182772868*^9},
 CellLabel->
  "Out[3324]//MatrixForm=",ExpressionUUID->"1bd43fbe-6be4-450f-ba69-\
d9414d59ad12"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"assum", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cg", ">", "0"}], ",", 
     RowBox[{"Cc", ">", "0"}], ",", 
     RowBox[{"Cj1", ">", "0"}], ",", 
     RowBox[{"Lj", ">", "0"}], ",", 
     RowBox[{"R", ">", "0"}], ",", 
     RowBox[{"Cd", ">", "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I3", "=", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y3P", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "R"}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"I3", "-", "S"}], ")"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"I3", "+", "S"}], "]"}]}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y3P", "/.", 
   RowBox[{"{", 
    RowBox[{"phi", "->", 
     RowBox[{"2", 
      RowBox[{"Pi", "/", "3"}]}]}], "}"}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"Y3P", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixRank", "[", "Y3P", "]"}]}], "Input",
 CellChangeTimes->{{3.924805986891374*^9, 3.924805989442855*^9}, {
  3.924877711637781*^9, 3.924877718959193*^9}},
 CellLabel->
  "In[3325]:=",ExpressionUUID->"ad7de5ef-e162-4368-84d5-590ab738e07b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["1", "R"], 
      RowBox[{"-", 
       FractionBox["1", "R"]}]},
     {
      RowBox[{"-", 
       FractionBox["1", "R"]}], "0", 
      FractionBox["1", "R"]},
     {
      FractionBox["1", "R"], 
      RowBox[{"-", 
       FractionBox["1", "R"]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.924805981608301*^9, 3.924805989718803*^9}, 
   3.9248692941027117`*^9, 3.924877719286457*^9, {3.925132147493121*^9, 
   3.9251321715327873`*^9}, 3.925282877874563*^9, {3.925317418520101*^9, 
   3.925317418579995*^9}, 3.925382641811095*^9, 3.925387646813012*^9, {
   3.925394638275571*^9, 3.925394640857348*^9}, 3.925402340618966*^9, 
   3.925405984558053*^9, 3.925406140665214*^9, 3.925406220120523*^9, 
   3.925407324040328*^9, 3.92546223963105*^9, {3.925462708565179*^9, 
   3.925462722681431*^9}, {3.925462864821398*^9, 3.925462885333303*^9}, 
   3.925463031018228*^9, 3.9254630783149147`*^9, 3.925463189857736*^9, 
   3.9254635682672443`*^9, 3.925464106747759*^9, 3.925464833240443*^9, 
   3.925464933724462*^9, {3.9254649792368803`*^9, 3.9254650072786713`*^9}, 
   3.9254658188781977`*^9, {3.925467735521716*^9, 3.9254677778317966`*^9}, 
   3.9254688472842484`*^9, 3.9254891036030416`*^9, 3.9254893125096073`*^9, 
   3.9254914860086203`*^9, 3.925491615522828*^9, 3.925491712129642*^9, 
   3.925491985448262*^9, 3.925492300822336*^9, 3.9254925902052803`*^9, 
   3.925492879879128*^9, 3.925543769191119*^9, 3.9255445856011333`*^9, {
   3.925544864599736*^9, 3.925544893467754*^9}, 3.925544996011907*^9, 
   3.925545151982003*^9, 3.9255453386545477`*^9, 3.925546898257897*^9, 
   3.925552789474262*^9, 3.9255531323657503`*^9, 3.9255543839881144`*^9, 
   3.92555492353555*^9, 3.925555030928913*^9, 3.925555218245668*^9, 
   3.9255609677362337`*^9, 3.925561212233304*^9, 3.925561370314659*^9, 
   3.925561524011354*^9, {3.925659728859268*^9, 3.925659752667762*^9}, 
   3.925663270305603*^9, 3.926698561066662*^9, 3.926701182806261*^9},
 CellLabel->
  "Out[3328]//MatrixForm=",ExpressionUUID->"934f0ead-75bf-4843-97d9-\
3d6adccd73cf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox[
       RowBox[{"Tan", "[", 
        FractionBox["phi", "2"], "]"}], 
       RowBox[{
        SqrtBox["3"], " ", "R"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Tan", "[", 
         FractionBox["phi", "2"], "]"}], 
        RowBox[{
         SqrtBox["3"], " ", "R"}]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Tan", "[", 
         FractionBox["phi", "2"], "]"}], 
        RowBox[{
         SqrtBox["3"], " ", "R"}]]}], "0", 
      FractionBox[
       RowBox[{"Tan", "[", 
        FractionBox["phi", "2"], "]"}], 
       RowBox[{
        SqrtBox["3"], " ", "R"}]]},
     {
      FractionBox[
       RowBox[{"Tan", "[", 
        FractionBox["phi", "2"], "]"}], 
       RowBox[{
        SqrtBox["3"], " ", "R"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Tan", "[", 
         FractionBox["phi", "2"], "]"}], 
        RowBox[{
         SqrtBox["3"], " ", "R"}]]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.924805981608301*^9, 3.924805989718803*^9}, 
   3.9248692941027117`*^9, 3.924877719286457*^9, {3.925132147493121*^9, 
   3.9251321715327873`*^9}, 3.925282877874563*^9, {3.925317418520101*^9, 
   3.925317418579995*^9}, 3.925382641811095*^9, 3.925387646813012*^9, {
   3.925394638275571*^9, 3.925394640857348*^9}, 3.925402340618966*^9, 
   3.925405984558053*^9, 3.925406140665214*^9, 3.925406220120523*^9, 
   3.925407324040328*^9, 3.92546223963105*^9, {3.925462708565179*^9, 
   3.925462722681431*^9}, {3.925462864821398*^9, 3.925462885333303*^9}, 
   3.925463031018228*^9, 3.9254630783149147`*^9, 3.925463189857736*^9, 
   3.9254635682672443`*^9, 3.925464106747759*^9, 3.925464833240443*^9, 
   3.925464933724462*^9, {3.9254649792368803`*^9, 3.9254650072786713`*^9}, 
   3.9254658188781977`*^9, {3.925467735521716*^9, 3.9254677778317966`*^9}, 
   3.9254688472842484`*^9, 3.9254891036030416`*^9, 3.9254893125096073`*^9, 
   3.9254914860086203`*^9, 3.925491615522828*^9, 3.925491712129642*^9, 
   3.925491985448262*^9, 3.925492300822336*^9, 3.9254925902052803`*^9, 
   3.925492879879128*^9, 3.925543769191119*^9, 3.9255445856011333`*^9, {
   3.925544864599736*^9, 3.925544893467754*^9}, 3.925544996011907*^9, 
   3.925545151982003*^9, 3.9255453386545477`*^9, 3.925546898257897*^9, 
   3.925552789474262*^9, 3.9255531323657503`*^9, 3.9255543839881144`*^9, 
   3.92555492353555*^9, 3.925555030928913*^9, 3.925555218245668*^9, 
   3.9255609677362337`*^9, 3.925561212233304*^9, 3.925561370314659*^9, 
   3.925561524011354*^9, {3.925659728859268*^9, 3.925659752667762*^9}, 
   3.925663270305603*^9, 3.926698561066662*^9, 3.926701182808832*^9},
 CellLabel->
  "Out[3329]//MatrixForm=",ExpressionUUID->"16701054-f9e7-48ea-a75d-\
6b1b1bbd66e0"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.924805981608301*^9, 3.924805989718803*^9}, 
   3.9248692941027117`*^9, 3.924877719286457*^9, {3.925132147493121*^9, 
   3.9251321715327873`*^9}, 3.925282877874563*^9, {3.925317418520101*^9, 
   3.925317418579995*^9}, 3.925382641811095*^9, 3.925387646813012*^9, {
   3.925394638275571*^9, 3.925394640857348*^9}, 3.925402340618966*^9, 
   3.925405984558053*^9, 3.925406140665214*^9, 3.925406220120523*^9, 
   3.925407324040328*^9, 3.92546223963105*^9, {3.925462708565179*^9, 
   3.925462722681431*^9}, {3.925462864821398*^9, 3.925462885333303*^9}, 
   3.925463031018228*^9, 3.9254630783149147`*^9, 3.925463189857736*^9, 
   3.9254635682672443`*^9, 3.925464106747759*^9, 3.925464833240443*^9, 
   3.925464933724462*^9, {3.9254649792368803`*^9, 3.9254650072786713`*^9}, 
   3.9254658188781977`*^9, {3.925467735521716*^9, 3.9254677778317966`*^9}, 
   3.9254688472842484`*^9, 3.9254891036030416`*^9, 3.9254893125096073`*^9, 
   3.9254914860086203`*^9, 3.925491615522828*^9, 3.925491712129642*^9, 
   3.925491985448262*^9, 3.925492300822336*^9, 3.9254925902052803`*^9, 
   3.925492879879128*^9, 3.925543769191119*^9, 3.9255445856011333`*^9, {
   3.925544864599736*^9, 3.925544893467754*^9}, 3.925544996011907*^9, 
   3.925545151982003*^9, 3.9255453386545477`*^9, 3.925546898257897*^9, 
   3.925552789474262*^9, 3.9255531323657503`*^9, 3.9255543839881144`*^9, 
   3.92555492353555*^9, 3.925555030928913*^9, 3.925555218245668*^9, 
   3.9255609677362337`*^9, 3.925561212233304*^9, 3.925561370314659*^9, 
   3.925561524011354*^9, {3.925659728859268*^9, 3.925659752667762*^9}, 
   3.925663270305603*^9, 3.926698561066662*^9, 3.926701182812199*^9},
 CellLabel->
  "Out[3330]=",ExpressionUUID->"b7970068-0f72-49f6-b6d3-3cdc4ca0f9e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{"Y3P", "/.", "var"}], "]"}]], "Input",
 CellChangeTimes->{{3.9254660074716063`*^9, 3.9254660163231916`*^9}},
 CellLabel->
  "In[3331]:=",ExpressionUUID->"06113696-40f3-44c8-947a-4de269df74cf"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.925466011218857*^9, 3.925466016671048*^9}, {
   3.925467735551744*^9, 3.925467777882654*^9}, 3.925468847315394*^9, 
   3.9254891036331367`*^9, 3.9254893125404577`*^9, 3.925491486062551*^9, 
   3.925491615575973*^9, 3.9254917121620398`*^9, 3.925491985506325*^9, 
   3.925492300854211*^9, 3.92549259024125*^9, 3.9254928799120398`*^9, 
   3.925543769232712*^9, 3.9255445856544867`*^9, {3.925544864637979*^9, 
   3.925544893525345*^9}, 3.9255449960688*^9, 3.925545152014668*^9, 
   3.9255453386980886`*^9, 3.925546898290167*^9, 3.925552789506761*^9, 
   3.9255531323977203`*^9, 3.92555438402103*^9, 3.925554923569376*^9, 
   3.925555030962645*^9, 3.9255552182819557`*^9, 3.925560967771092*^9, 
   3.925561212268538*^9, 3.9255613703492823`*^9, 3.925561524044297*^9, {
   3.92565972886834*^9, 3.9256597526759167`*^9}, 3.9256632703186483`*^9, 
   3.9266985610806437`*^9, 3.926701182818585*^9},
 CellLabel->
  "Out[3331]=",ExpressionUUID->"3f78b09e-5baa-46a9-9f34-13408808c695"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Now we put the coupling resonators Crs, ground Cg, capacitance Cr, coupling \
Cjr and finally Cj\
\>", "Chapter",
 CellChangeTimes->{{3.924805997786515*^9, 3.924806023485113*^9}, {
  3.924806627889288*^9, 3.924806629795198*^9}, {3.9253852315970087`*^9, 
  3.925385237733389*^9}, {3.925385272255117*^9, 3.925385294754642*^9}, {
  3.925387677015998*^9, 
  3.92538767714598*^9}},ExpressionUUID->"3bd639d0-fcc2-4794-9be5-\
007799598c55"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Getting the full admittance and impedance ", \
"Subsubsection"]], "Section",
 CellChangeTimes->{{3.924806873979265*^9, 3.924806878324029*^9}, {
   3.92480731109648*^9, 3.924807315892495*^9}, {3.9253852632839127`*^9, 
   3.925385267937358*^9}, {3.925390929635222*^9, 3.925390938159555*^9}, 
   3.925401242973186*^9},ExpressionUUID->"9591d29f-b83b-4207-8840-\
0205d616a0fc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Yg", " ", "=", " ", 
   RowBox[{"s", "*", "Cg", "*", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ygs", " ", "=", " ", 
   RowBox[{"Y3P", "+", "Yg"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{
   RowBox[{"Ygs", "/.", "var"}], "/.", 
   RowBox[{"{", 
    RowBox[{"s", "->", 
     RowBox[{"I", "*", "40"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.925465988740176*^9, 3.925465993515107*^9}, {
  3.925466023750451*^9, 3.925466036354062*^9}},
 CellLabel->
  "In[3332]:=",ExpressionUUID->"9b76ef6d-6bd8-44f8-b360-5fb754f479b0"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.9254659839580383`*^9, 3.925465994360442*^9}, {
   3.9254660248504353`*^9, 3.925466036973843*^9}, 3.925466752989183*^9, {
   3.925467735594221*^9, 3.9254677779290857`*^9}, 3.92546884735424*^9, 
   3.925489103674567*^9, 3.9254893125873632`*^9, 3.925491486109668*^9, 
   3.925491615627253*^9, 3.925491712204769*^9, 3.925491985557844*^9, 
   3.925492300897488*^9, 3.925492590283149*^9, 3.925492879955883*^9, 
   3.9255437692918797`*^9, 3.925544585702407*^9, {3.925544864690806*^9, 
   3.925544893574128*^9}, 3.925544996126161*^9, 3.9255451520647*^9, 
   3.925545338757369*^9, 3.925546898332292*^9, 3.925552789549654*^9, 
   3.9255531324425993`*^9, 3.9255543840630627`*^9, 3.9255549236134*^9, 
   3.925555031005127*^9, 3.925555218329719*^9, 3.925560967817934*^9, 
   3.925561212312551*^9, 3.925561370391376*^9, 3.925561524085747*^9, {
   3.925659724198174*^9, 3.92565975271146*^9}, 3.925662209300048*^9, 
   3.9256632703581142`*^9, 3.926698561131628*^9, 3.9267011828592854`*^9},
 CellLabel->
  "Out[3334]=",ExpressionUUID->"afbc3e60-a244-4e6c-a046-45a1fa5c0f02"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Zc", " ", "=", " ", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "3", "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"Crs", "*", "s"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zcgs", " ", "=", " ", 
   RowBox[{"Zc", "+", 
    RowBox[{"Inverse", "[", "Ygs", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{
   RowBox[{"Zcgs", "/.", "var"}], "/.", 
   RowBox[{"{", 
    RowBox[{"s", "->", 
     RowBox[{"I", "*", "40"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.925466048277364*^9, 3.9254660591738586`*^9}},
 CellLabel->
  "In[3335]:=",ExpressionUUID->"fad00851-465e-40c2-b21d-2d3281cf0360"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.925466060221339*^9, 3.9254667541352377`*^9, {3.925467735609518*^9, 
   3.925467777967946*^9}, 3.925468847369666*^9, 3.925489103690262*^9, 
   3.9254893126248198`*^9, 3.925491486144339*^9, 3.925491615661618*^9, 
   3.925491712240553*^9, 3.9254919855954933`*^9, 3.9254923009141273`*^9, 
   3.925492590318698*^9, 3.925492879989792*^9, 3.9255437693366203`*^9, 
   3.925544585736115*^9, {3.925544864730497*^9, 3.925544893610023*^9}, 
   3.925544996167572*^9, 3.925545152082343*^9, 3.925545338778554*^9, 
   3.925546898366313*^9, 3.925552789584334*^9, 3.925553132460334*^9, 
   3.925554384100021*^9, 3.925554923633225*^9, 3.9255550310405283`*^9, 
   3.925555218350131*^9, 3.9255609678559837`*^9, 3.925561212333227*^9, 
   3.9255613704271603`*^9, 3.925561524105385*^9, {3.925659728931079*^9, 
   3.9256597527448072`*^9}, 3.925662209351997*^9, 3.925663270400362*^9, 
   3.9266985611584806`*^9, 3.9267011828934107`*^9},
 CellLabel->
  "Out[3337]=",ExpressionUUID->"a50de3bc-c031-4914-a05b-0d7e0ef10353"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ycr", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s", "*", "Cr"}], "+", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"Lr", "*", "s"}], ")"}]}]}], ")"}], "*", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yrcgs", " ", "=", " ", 
   RowBox[{"Apart", "[", 
    RowBox[{
     RowBox[{"Ycr", "+", 
      RowBox[{"Inverse", "[", "Zcgs", "]"}]}], ",", "s"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{
   RowBox[{"Yrcgs", "/.", "var"}], "/.", 
   RowBox[{"{", 
    RowBox[{"s", "->", 
     RowBox[{"I", "*", "40"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9254660698215857`*^9, 3.925466081627496*^9}},
 CellLabel->
  "In[3338]:=",ExpressionUUID->"41d0c229-0fe2-4a9f-af4e-e61ded413046"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.925466082861332*^9, 3.925466755615573*^9, {3.9254677358007393`*^9, 
   3.925467778162202*^9}, 3.925468847555332*^9, 3.9254891038817797`*^9, 
   3.925489312895524*^9, 3.9254914863419847`*^9, 3.925491615864043*^9, 
   3.925491712430747*^9, 3.9254919858174963`*^9, 3.925492301105516*^9, 
   3.925492590540057*^9, 3.925492880194111*^9, 3.9255437697650642`*^9, 
   3.925544585944766*^9, {3.925544864931715*^9, 3.9255448938375998`*^9}, 
   3.925544996426079*^9, 3.925545152268545*^9, 3.925545339022807*^9, 
   3.9255469009301577`*^9, 3.92555278986924*^9, 3.925553132650288*^9, 
   3.925554384297914*^9, 3.9255549238322983`*^9, 3.92555503134371*^9, 
   3.925555218552162*^9, 3.925560968249346*^9, 3.925561212523492*^9, 
   3.925561370616784*^9, 3.9255615242992*^9, {3.925659729277659*^9, 
   3.9256597529892406`*^9}, 3.925662209718961*^9, 3.925663270849819*^9, 
   3.926698561461535*^9, 3.926701183097541*^9},
 CellLabel->
  "Out[3340]=",ExpressionUUID->"613913fa-3212-4f13-8c61-298ac101f3ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Zjr", " ", "=", " ", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "3", "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"Cjr", "*", "s"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zcrcgs", " ", "=", " ", 
   RowBox[{"Apart", "[", 
    RowBox[{
     RowBox[{"Zjr", "+", 
      RowBox[{"Inverse", "[", "Yrcgs", "]"}]}], ",", "s"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{
   RowBox[{"Zcrcgs", "/.", "var"}], "/.", 
   RowBox[{"{", 
    RowBox[{"s", "->", 
     RowBox[{"I", "*", "40"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.925466091131939*^9, 3.925466103155513*^9}},
 CellLabel->
  "In[3341]:=",ExpressionUUID->"fd85271e-371a-46d0-b61b-683be4a6b010"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.92546610518246*^9, {3.925467737065278*^9, 3.92546777939176*^9}, 
   3.92546884864423*^9, 3.925489105092326*^9, 3.92548931587283*^9, 
   3.925491487662333*^9, 3.925491617081092*^9, 3.9254917135940733`*^9, 
   3.925491986990872*^9, 3.925492302283119*^9, 3.9254925918296213`*^9, 
   3.925492881453252*^9, 3.9255437720186777`*^9, 3.9255445873125753`*^9, {
   3.925544866330821*^9, 3.925544895151579*^9}, 3.9255449980972157`*^9, 
   3.9255451534450483`*^9, 3.925545340569563*^9, 3.92554690330451*^9, 
   3.925552791639344*^9, 3.92555313390703*^9, 3.925554385453174*^9, 
   3.925554925023438*^9, 3.925555033949196*^9, 3.925555220131369*^9, 
   3.925560971108762*^9, 3.925561213733707*^9, 3.925561371770701*^9, 
   3.9255615255662394`*^9, {3.925659731445746*^9, 3.9256597544159527`*^9}, 
   3.925662211899949*^9, 3.925663273317542*^9, 3.926698563333494*^9, 
   3.9267011843764257`*^9},
 CellLabel->
  "Out[3343]=",ExpressionUUID->"715204fa-3d4e-4cf7-a55e-2b7b882ec02a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Yj", " ", "=", " ", 
   RowBox[{"Cj", "*", "s", "*", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ymat", " ", "=", " ", 
   RowBox[{"Apart", "[", 
    RowBox[{
     RowBox[{"Yj", "+", 
      RowBox[{"Inverse", "[", "Zcrcgs", "]"}]}], ",", "s"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{
   RowBox[{"Ymat", "/.", "var"}], "/.", 
   RowBox[{"{", 
    RowBox[{"s", "->", 
     RowBox[{"I", "*", "40"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.92546611384906*^9, 3.925466123615121*^9}},
 CellLabel->
  "In[3344]:=",ExpressionUUID->"f3f4c938-1f43-4db0-9f3d-929e8ec3f613"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.925466129448045*^9, {3.9254677424556513`*^9, 3.925467784382617*^9}, 
   3.925468853155243*^9, 3.925489109825583*^9, 3.925489324155547*^9, 
   3.9254914932468853`*^9, 3.92549162192659*^9, 3.9254917183840513`*^9, 
   3.925491991814602*^9, 3.9254923072744493`*^9, 3.9254925966488457`*^9, 
   3.925492886319072*^9, 3.925543781235276*^9, 3.9255445931997547`*^9, {
   3.9255448718962812`*^9, 3.9255449007084846`*^9}, 3.925545004390724*^9, 
   3.925545158230435*^9, 3.92554534635565*^9, 3.9255469115563803`*^9, 
   3.925552800845655*^9, 3.925553138838585*^9, 3.925554390834415*^9, 
   3.9255549301108427`*^9, 3.925555042596696*^9, 3.925555226259954*^9, 
   3.925560979952931*^9, 3.925561219063147*^9, 3.925561376629733*^9, 
   3.92556153103577*^9, {3.925659738535173*^9, 3.925659760688889*^9}, 
   3.925662222572489*^9, 3.9256632833272552`*^9, 3.9266985723174963`*^9, 
   3.926701190006878*^9},
 CellLabel->
  "Out[3346]=",ExpressionUUID->"e7d88ef4-692d-44c9-bf78-8975f411bc27"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Zmat", " ", "=", 
   RowBox[{"Apart", "[", 
    RowBox[{
     RowBox[{"Inverse", "[", "Ymat", "]"}], ",", "s"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{
   RowBox[{"Zmat", "/.", "var"}], "/.", 
   RowBox[{"{", 
    RowBox[{"s", "->", 
     RowBox[{"I", "*", "40"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.925466136016452*^9, 3.925466146984085*^9}},
 CellLabel->
  "In[3347]:=",ExpressionUUID->"1982cc99-5151-44d0-aefe-9e928b780ac2"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.925466181807055*^9, {3.925467742889572*^9, 3.925467769832015*^9}, 
   3.9254678178441*^9, 3.925468891735553*^9, 3.92548914248837*^9, 
   3.925489362546896*^9, 3.9254915275414886`*^9, 3.925491655011425*^9, 
   3.925491751449181*^9, 3.925492025143559*^9, 3.925492341480592*^9, 
   3.9254926310326843`*^9, 3.9254929236692038`*^9, 3.925543826865027*^9, 
   3.925544636543646*^9, 3.925544876733032*^9, 3.925544941448924*^9, 
   3.9255450443507557`*^9, 3.925545191197822*^9, 3.925545384961154*^9, 
   3.92554695016115*^9, 3.925552841543709*^9, 3.92555317661522*^9, 
   3.9255544261819*^9, 3.925554965271594*^9, 3.925555081146145*^9, 
   3.925555268012624*^9, 3.925561019671966*^9, 3.925561253543277*^9, 
   3.925561413368639*^9, 3.9255615667154512`*^9, 3.925659810380239*^9, 
   3.9256622724062767`*^9, 3.92566333288546*^9, 3.926698613925967*^9, 
   3.926701198773931*^9},
 CellLabel->
  "Out[3347]=",ExpressionUUID->"b59869d3-c2b4-41a4-9f9d-f4b070ad0801"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.925466181807055*^9, {3.925467742889572*^9, 3.925467769832015*^9}, 
   3.9254678178441*^9, 3.925468891735553*^9, 3.92548914248837*^9, 
   3.925489362546896*^9, 3.9254915275414886`*^9, 3.925491655011425*^9, 
   3.925491751449181*^9, 3.925492025143559*^9, 3.925492341480592*^9, 
   3.9254926310326843`*^9, 3.9254929236692038`*^9, 3.925543826865027*^9, 
   3.925544636543646*^9, 3.925544876733032*^9, 3.925544941448924*^9, 
   3.9255450443507557`*^9, 3.925545191197822*^9, 3.925545384961154*^9, 
   3.92554695016115*^9, 3.925552841543709*^9, 3.92555317661522*^9, 
   3.9255544261819*^9, 3.925554965271594*^9, 3.925555081146145*^9, 
   3.925555268012624*^9, 3.925561019671966*^9, 3.925561253543277*^9, 
   3.925561413368639*^9, 3.9255615667154512`*^9, 3.925659810380239*^9, 
   3.9256622724062767`*^9, 3.92566333288546*^9, 3.926698613925967*^9, 
   3.9267011988257523`*^9},
 CellLabel->
  "Out[3348]=",ExpressionUUID->"ae8569d6-3624-4a53-9493-0e25b2b62e04"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"A0", " ", "=", " ", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"Zmat", "*", "s"}], ",", 
     RowBox[{"s", "->", "0"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.925663080430338*^9, 3.925663095216488*^9}},
 CellLabel->
  "In[3301]:=",ExpressionUUID->"e286532a-1557-4e70-aef4-31566de9974a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A0", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.925663368544963*^9, 3.925663370100559*^9}},
 CellLabel->
  "In[3302]:=",ExpressionUUID->"13423fba-ce8d-490f-8c31-fd01b5c94257"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"Cj", "+", "Cjr"}]], "0", "0"},
     {"0", 
      FractionBox["1", 
       RowBox[{"Cj", "+", "Cjr"}]], "0"},
     {"0", "0", 
      FractionBox["1", 
       RowBox[{"Cj", "+", "Cjr"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.925663370417162*^9, 3.9266986152277517`*^9},
 CellLabel->
  "Out[3302]//MatrixForm=",ExpressionUUID->"ffcda955-af53-440a-9ffa-\
4cfa455455a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"path", " ", "=", " ", "\"\<Mathematica-files/\>\""}], 
  RowBox[{"(*", 
   RowBox[{
   "folder", " ", "where", " ", "all", " ", "Mathematica", " ", "files", " ", 
    "are", " ", "saved", " ", "and", " ", "read"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"path", ",", "\"\<Zmat.wl\>\""}], "]"}], ",", "Zmat"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{"path", ",", "\"\<A0.wl\>\""}], "]"}], ",", "A0"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.925659702810441*^9, 3.9256597175141363`*^9}, {
  3.925659748855443*^9, 3.925659749384306*^9}, {3.9256618922352962`*^9, 
  3.925661899684655*^9}, {3.925661987489944*^9, 3.9256619881923237`*^9}, {
  3.925662113506146*^9, 3.92566211597715*^9}, {3.9256623525188217`*^9, 
  3.925662353751225*^9}, {3.925662480953711*^9, 3.9256624815053263`*^9}, {
  3.925663117491267*^9, 3.925663121801992*^9}, {3.927015928688528*^9, 
  3.927015937850625*^9}, {3.9270159690147943`*^9, 
  3.927015977984559*^9}},ExpressionUUID->"87a7c2b4-9535-4f36-a812-\
c1408720e6a7"],

Cell[BoxData["\<\"/Users/lautarolabarca/Library/CloudStorage/OneDrive-\
USherbrooke/Research-folders/Projects/Bbox/Codes/Mathematica-files/\"\>"], \
"Output",
 CellChangeTimes->{3.925659700783095*^9, 3.92565981051233*^9, 
  3.925661900254321*^9, 3.9256619885998*^9, 3.92566211664037*^9, 
  3.925662272579914*^9, 3.9256623542979717`*^9, 3.925662481804459*^9, 
  3.925663122708817*^9, 3.9256633341735497`*^9, 3.925663480608963*^9, 
  3.926698615240896*^9},
 CellLabel->
  "Out[3303]=",ExpressionUUID->"3a519023-0d3f-425d-910d-4d0f54d2347d"],

Cell[BoxData["\<\"/Users/lautarolabarca/Library/CloudStorage/OneDrive-\
USherbrooke/Research-folders/Projects/Bbox/Codes/Mathematica-files/Zmat.wl\"\>\
"], "Output",
 CellChangeTimes->{3.925659700783095*^9, 3.92565981051233*^9, 
  3.925661900254321*^9, 3.9256619885998*^9, 3.92566211664037*^9, 
  3.925662272579914*^9, 3.9256623542979717`*^9, 3.925662481804459*^9, 
  3.925663122708817*^9, 3.9256633341735497`*^9, 3.925663480608963*^9, 
  3.92669861531459*^9},
 CellLabel->
  "Out[3304]=",ExpressionUUID->"e7963e9a-8d76-4554-affd-17c4dc3bcad7"],

Cell[BoxData["\<\"/Users/lautarolabarca/Library/CloudStorage/OneDrive-\
USherbrooke/Research-folders/Projects/Bbox/Codes/Mathematica-files/A0.wl\"\>"]\
, "Output",
 CellChangeTimes->{3.925659700783095*^9, 3.92565981051233*^9, 
  3.925661900254321*^9, 3.9256619885998*^9, 3.92566211664037*^9, 
  3.925662272579914*^9, 3.9256623542979717`*^9, 3.925662481804459*^9, 
  3.925663122708817*^9, 3.9256633341735497`*^9, 3.925663480608963*^9, 
  3.9266986153206453`*^9},
 CellLabel->
  "Out[3305]=",ExpressionUUID->"ead4734e-c58f-41d8-b8b6-84ddd2b5b6ee"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{316, Automatic}, {Automatic, 50}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"02f08475-806b-466a-8627-ab221af111ac"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 186, 3, 98, "Title",ExpressionUUID->"f7d9a2fc-2c7f-4264-8593-373c5e8eead6"],
Cell[CellGroupData[{
Cell[791, 29, 1114, 21, 94, "Input",ExpressionUUID->"50cc4282-9269-4ec5-9bbf-c6fd43178e26"],
Cell[1908, 52, 2572, 64, 34, "Output",ExpressionUUID->"60782d04-5102-4118-a30a-90b1f2bef16b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4517, 121, 216, 4, 53, "Subtitle",ExpressionUUID->"b3e78691-0abe-4061-9e34-bb48caf0132a"],
Cell[CellGroupData[{
Cell[4758, 129, 6226, 193, 388, "Input",ExpressionUUID->"eb613276-7ebe-46ef-9df0-035a067b1ca8"],
Cell[10987, 324, 4398, 110, 104, "Output",ExpressionUUID->"9e24bbc8-2b86-4d7b-874d-66e2fe0edf61"],
Cell[15388, 436, 2366, 44, 76, "Output",ExpressionUUID->"1bd43fbe-6be4-450f-ba69-d9414d59ad12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17791, 485, 1296, 39, 136, "Input",ExpressionUUID->"ad7de5ef-e162-4368-84d5-590ab738e07b"],
Cell[19090, 526, 2489, 51, 100, "Output",ExpressionUUID->"934f0ead-75bf-4843-97d9-3d6adccd73cf"],
Cell[21582, 579, 3161, 75, 142, "Output",ExpressionUUID->"16701054-f9e7-48ea-a75d-6b1b1bbd66e0"],
Cell[24746, 656, 1770, 25, 34, "Output",ExpressionUUID->"b7970068-0f72-49f6-b6d3-3cdc4ca0f9e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26553, 686, 262, 5, 30, "Input",ExpressionUUID->"06113696-40f3-44c8-947a-4de269df74cf"],
Cell[26818, 693, 1024, 15, 34, "Output",ExpressionUUID->"3f78b09e-5baa-46a9-9f34-13408808c695"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27891, 714, 443, 9, 69, "Chapter",ExpressionUUID->"3bd639d0-fcc2-4794-9be5-007799598c55"],
Cell[CellGroupData[{
Cell[28359, 727, 396, 6, 56, "Section",ExpressionUUID->"9591d29f-b83b-4207-8840-0205d616a0fc"],
Cell[CellGroupData[{
Cell[28780, 737, 678, 18, 73, "Input",ExpressionUUID->"9b76ef6d-6bd8-44f8-b360-5fb754f479b0"],
Cell[29461, 757, 1111, 16, 34, "Output",ExpressionUUID->"afbc3e60-a244-4e6c-a046-45a1fa5c0f02"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30609, 778, 708, 19, 73, "Input",ExpressionUUID->"fad00851-465e-40c2-b21d-2d3281cf0360"],
Cell[31320, 799, 1050, 16, 34, "Output",ExpressionUUID->"a50de3bc-c031-4914-a05b-0d7e0ef10353"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32407, 820, 892, 27, 73, "Input",ExpressionUUID->"41d0c229-0fe2-4a9f-af4e-e61ded413046"],
Cell[33302, 849, 1042, 16, 34, "Output",ExpressionUUID->"613913fa-3212-4f13-8c61-298ac101f3ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34381, 870, 779, 22, 73, "Input",ExpressionUUID->"fd85271e-371a-46d0-b61b-683be4a6b010"],
Cell[35163, 894, 1018, 16, 34, "Output",ExpressionUUID->"715204fa-3d4e-4cf7-a55e-2b7b882ec02a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36218, 915, 734, 21, 73, "Input",ExpressionUUID->"f3f4c938-1f43-4db0-9f3d-929e8ec3f613"],
Cell[36955, 938, 1027, 16, 34, "Output",ExpressionUUID->"e7d88ef4-692d-44c9-bf78-8975f411bc27"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38019, 959, 540, 15, 52, "Input",ExpressionUUID->"1982cc99-5151-44d0-aefe-9e928b780ac2"],
Cell[38562, 976, 1010, 16, 34, "Output",ExpressionUUID->"b59869d3-c2b4-41a4-9f9d-f4b070ad0801"],
Cell[39575, 994, 1008, 16, 34, "Output",ExpressionUUID->"ae8569d6-3624-4a53-9493-0e25b2b62e04"]
}, Open  ]],
Cell[40598, 1013, 342, 9, 30, "Input",ExpressionUUID->"e286532a-1557-4e70-aef4-31566de9974a"],
Cell[CellGroupData[{
Cell[40965, 1026, 210, 4, 30, "Input",ExpressionUUID->"13423fba-ce8d-490f-8c31-fd01b5c94257"],
Cell[41178, 1032, 846, 26, 106, "Output",ExpressionUUID->"ffcda955-af53-440a-9ffa-4cfa455455a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42061, 1063, 1178, 26, 73, "Input",ExpressionUUID->"87a7c2b4-9535-4f36-a812-c1408720e6a7"],
Cell[43242, 1091, 538, 9, 34, "Output",ExpressionUUID->"3a519023-0d3f-425d-910d-4d0f54d2347d"],
Cell[43783, 1102, 544, 9, 34, "Output",ExpressionUUID->"e7963e9a-8d76-4554-affd-17c4dc3bcad7"],
Cell[44330, 1113, 545, 9, 34, "Output",ExpressionUUID->"ead4734e-c58f-41d8-b8b6-84ddd2b5b6ee"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

